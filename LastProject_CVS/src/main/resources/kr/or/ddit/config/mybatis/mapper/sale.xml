<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sale">
	
	
	
	
	<!-- 	아 이 디 : setInsertSaleList
	  		매개변수 : disposalListVo
	  		반 환 값 : 
	  		설    명 : 판매 상세 리스트 추가
	  		작 성 자 : 한수정
	  		일    시 : 2018-09-14     
	 -->
	<insert id="setInsertSaleList" parameterType="saleListVo">
		
		INSERT INTO DISPOSAL_LIST
		(
			DISP_ID
			DISP_AMOUNT
			DISP_EXDATE
			SD_ID
			BCD_ID
		)
		VALUES (
			#{disp_id    },  --<!--// 폐기상세리스트 id  -->
			#{disp_amount},	 --<!--// 해당제품 폐기된 개수  -->
			#{disp_exdate},	 --<!--// 해당 제품 유통기한-->
			#{sd_id      },	 --<!--// 판매폐기 id -->
			#{bcd_id     }	 --<!--// 재고 id-->
		)
	</insert>
	
	
	<!-- 해당 id 사용자의 모든 결제내역 조회 --> <!-- 09.11 KONG 수정함   -->
	<select id="getMyPayList" parameterType="String" resultType="payVo">
		SELECT PAY_ID
			 , PAY_SUM
			 , PAY_DATE
			 , PAY_NY
			 , MEM_ID
			 , SD_ID
			 , PAY_CASH
			 , PAY_CARD
			 , SHIPLIST_ID
		 FROM PAY
		WHERE MEM_ID = #{mem_id}
	</select>
	
	
	<!-- 	아 이 디 : getMyPayPageList
	  		반 환 값 : payVo
	  		매개변수 : payVo
	  		설    명 : 해당 id 사용자의 모든 결제내역 리스트 조회
	  		작 성 자 : 공은별
	  		일    시 : 2018-09-11     
	 -->
	<select id="getMyPayPageList" parameterType="payVo" resultType="payVo">
		SELECT *
		FROM (SELECT a.*, ROWNUM rn
			  FROM
				  (SELECT COUNT(*) OVER() AS TOT_CNT
				        , PAY_ID
						, PAY_SUM
						, PAY_DATE
						, PAY_NY
						, MEM_ID
						, SD_ID
						, PAY_CASH
						, PAY_CARD
						, SHIPLIST_ID
					 FROM PAY
					WHERE MEM_ID = #{mem_id}
					ORDER BY pay_date DESC)
			  a )
		WHERE rn BETWEEN (#{page}-1)*#{pageSize}+1 AND #{page}*#{pageSize}
	</select>
	
</mapper>	