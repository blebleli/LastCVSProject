<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="category">

<select id="prodCtgyList" resultType="categoryVo">
	SELECT ctgy_id, ctgy_name, ctgy_parent, ctgy_group, level
		FROM category
		WHERE ctgy_kind = 301
		START WITH ctgy_parent is null   
		CONNECT BY PRIOR ctgy_id = ctgy_parent
</select>

<select id="getCtgy" parameterType="String" resultType="categoryVo">
	SELECT * 
	FROM category 
	WHERE ctgy_id=#{ctgy_id}
</select>

<!-- 	아 이 디 : getProdCategory
  		반 환 값 : categoryVo
  		매개변수 : ctgy_parent : is null , is not null
  		설    명 : 관리자 카테고리 조회 
  		작 성 자 : 조종원
  		일    시 : 2018-09-17
 -->
 <!--	김마음 : 관리자 게시판 리스트 내 검색 기능(대분류 검색)
		일    시 : 2018-09-22
 -->
<select id="getProdCategory" parameterType="categoryVo" resultType="categoryVo">

	SELECT  * 
	FROM CATEGORY 
	WHERE 1=1
			<if test="ctgy_parent == null and ctgy_parent == '' ">
				AND	CTGY_PARENT			IS NULL
			</if>
			<if test="ctgy_parent != null and ctgy_parent != '' ">
				AND CTGY_PARENT			IS NOT NULL
			</if>  
      AND CTGY_KIND = #{ctgy_kind}
</select>

<!-- 	아 이 디 : getProdCategoryMd
  		반 환 값 : categoryVo
  		설     명 : 관리자 카테고리 중분류 조회 
  		작 성 자 : 김마음
  		일     시 : 2018-09-23
 -->
<select id="getProdCategoryMd" parameterType="String" resultType="categoryVo">
	SELECT ctgy_name
	FROM CATEGORY
	WHERE CTGY_GROUP = (SELECT CTGY_GROUP FROM CATEGORY WHERE CTGY_NAME = #{ctgy_name})
	AND CTGY_PARENT IS NOT NULL
</select>


<!-- 	아 이 디 : setCategoryInsert
  		반 환 값 : 
  		매개변수 : categoryVo
  		설    명 : 관리자 카테고리 insert 
  		작 성 자 : 조종원
  		일    시 : 2018-09-18
 -->
 <insert id="setCategoryInsert" parameterType="categoryVo">
 INSERT INTO CATEGORY ( CTGY_ID, CTGY_NAME, CTGY_INFO, CTGY_GROUP, CTGY_KIND, CTGY_PARENT ) 
        VALUES(
        		 #{ctgy_id    } 
				,#{ctgy_name  } 
				,#{ctgy_info  } 
				,#{ctgy_group } 
				,#{ctgy_kind  } 
				,#{ctgy_parent} 
        )
 </insert>
 
 <!-- 	아 이 디 : getCvsServiceCtgy
  		반 환 값 :  categoryVo
  		매개변수 : 
  		설    명 : 편의점 서비스 카테고리 조회 
  		작 성 자 : 김현경
  		일    시 : 2018-09-18
 -->
 <select id="getCvsServiceCtgy" resultType="categoryVo">
 	select * from category where ctgy_kind = '302'
 </select>

 <!-- 	아 이 디 : getService
  		반 환 값 :  cvsServiceVo
  		매개변수 : String 편의점 id
  		설    명 : 편의점 서비스 조회 
  		작 성 자 : 김현경
  		일    시 : 2018-09-18
 -->
<select id="getService" parameterType="String" resultType="cvsServiceVo">
	select * from cvs_service where place_id = #{place_id}
</select>

</mapper>