<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="boardJoin">
	<!-- 관리자 - 게시판 페이징 기법 -->
	<select id="adBoardViewList" parameterType="map" resultType="boardJoinVo">
	
	SELECT * FROM (
		SELECT ROWNUM cnt, T.*
				FROM  (
				        SELECT    (SELECT prod_name FROM prod WHERE board.prod_id = prod.prod_id) AS prod_name
								, (SELECT mem_name FROM member WHERE board.mem_id = member.mem_id) AS mem_name
								, bd_title
								, bd_rating
								, bd_date
								, mem_id
								, bd_kind_id
								, prod_id
								, bd_id
								, bd_del
						FROM board
		              	WHERE bd_kind_id=#{bd_kind_id}
						ORDER BY bd_date DESC       
		      ) T )  WHERE cnt BETWEEN (#{page}-1)*#{pageSize}+1 AND #{page}*#{pageSize}
	</select>
	<!-- 
		select * from (
		SELECT ROWNUM CNT, T.*
				FROM  (
				        SELECT    (SELECT PROD_NAME FROM PROD WHERE BOARD.PROD_ID = PROD.PROD_ID) AS PROD_NAME
								, (SELECT MEM_NAME FROM MEMBER WHERE BOARD.MEM_ID = MEMBER.MEM_ID) AS MEM_NAME
								, BD_TITLE
								, BD_RATING
								, BD_DATE
								, MEM_ID
								, BD_KIND_ID
								, PROD_ID
								, BD_ID
						FROM BOARD
		              	WHERE BD_KIND_ID=#{BD_KIND_ID}
						ORDER BY BD_DATE DESC       
		      ) T )  WHERE CNT BETWEEN (#{page}-1)*#{pageSize}+1 AND #{page}*#{pageSize} -->
	
	<!-- 전체 건수 -->
  	<select id="getBoardTotCnt" resultType="int">
    	SELECT COUNT(*) FROM BOARD
  	</select>
  	
  	<!-- 관리자 - 게시글 등록 -->
  	<insert id="boardCreate" parameterType="boardJoinVo">
		INSERT INTO board (
							  bd_id
					 		, bd_title
					 		, bd_content
					 		, bd_date
					 		, bd_del
					 		, bd_rating
					 		, bd_views
					 		, bd_group
					 		, mem_id
					 		, bd_parent
					 		, bd_kind_id
							)
					VALUES (							  
							  #{bd_id}
					 		, #{bd_title}
					 		, RAWTOHEX(#{bd_content})
					 		, sysdate
					 		, 'N'
					 		, null
					 		, 0
					 		, #{bd_id}
					 		, 'admin'
					 		, null
					 		, #{bd_kind_id}
					 		)
  	</insert>
  	
  	<!-- 관리자 - 게시글 상세조회 -->
  	<select id="boardDetail" parameterType="String" resultType="boardJoinVo">
		SELECT	  bd_id
		 		, bd_title
		 		, UTL_RAW.CAST_TO_VARCHAR2(bd_content)
		 		, bd_date
		 		, bd_del
		 		, bd_rating
		 		, bd_views
		 		, bd_group
		 		, mem_id
		 		, bd_parent
		 		, bd_kind_id
		FROM board
		WHERE bd_id=#{bd_id}
  	</select>
</mapper>