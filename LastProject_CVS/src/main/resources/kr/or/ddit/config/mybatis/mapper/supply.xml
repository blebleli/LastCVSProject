<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="supply">

	<!-- 	아 이 디 : getListSupply
	  		반 환 값 : supplySumProdVo
	  		매개변수 : 
	  		설    명 : 입고 목록 전체 출력 
	  		작 성 자 : 조계환
	  		일    시 : 2018-09-11     
	 -->
	<select id="getListSupply" resultType="supplySumProdVo">
		SELECT rownum rnum,T.*
		FROM
		(
		      SELECT a.supply_bcd, a.supply_date,a.supply_state, sum(b.splylist_sum) splylist_sum, sum(c.prod_price*b.splylist_sum) sum
		      FROM supply a, supply_list b, prod c
		      WHERE a.place_id='3630000-104-2015-00121' 
		      AND c.prod_id = b.prod_id   
		      AND a.supply_bcd = b.supply_bcd
		      GROUP BY a.supply_bcd, a.supply_date,a.supply_state
		) T   
	</select>
	
	<!-- 	아 이 디 : supplyDetail
	  		반 환 값 : supplyListVo
	  		매개변수 : string(supply_bcd)
	  		설    명 : 입고 목록중 하나를 클릭했을때 정보 출력
	  		작 성 자 : 조계환
	  		일    시 : 2018-09-11     
	 -->
	<select id="supplyDetail" parameterType="String" resultType="supplyListVo">
		SELECT * FROM supply_list WHERE supply_bcd = #{supply_bcd}
	</select>
	
	<!-- 	아 이 디 : supplyDetailProdList
	  		반 환 값 : supplyListVo
	  		매개변수 : string(supply_bcd)
	  		설    명 : 입고 목록중 하나를 클릭했을때 그에 대한 정보를 가져온다(supply_list) 
	  		작 성 자 : 조계환
	  		일    시 : 2018-09-11     
	 -->
	<select id="supplyDetailProdList" parameterType="String" resultType="supplyListVo">
		SELECT * FROM supply_list WHERE supply_bcd=#{supply_bcd}  
	</select>
	
	<!-- 	아 이 디 : supplyProdInfo
	  		반 환 값 : SupplyProdVo
	  		매개변수 : string(supply_bcd)
	  		설    명 : 입고 상세 보기 내역에서 필요한 정보(수량,제품이름,제품코드)를 가져오는 쿼리
	  		작 성 자 : 조계환
	  		일    시 : 2018-09-11     
	 -->
	<select id="supplyProdInfo" parameterType="String" resultType="supplyProdVo">
		SELECT a.prod_id, a.prod_name, a.prod_price, b.splylist_sum
		FROM prod a, supply_list  b
		WHERE b.supply_bcd=#{supply_bcd}
		AND a.prod_id = b.prod_id
	</select>
	
	<!-- 	아 이 디 : sumProdPrice
	  		반 환 값 : Integer
	  		매개변수 : string(supply_bcd)
	  		설    명 : 클릭한 입고 상세내역에서 제품들의 가격들의 총합을 구하는 쿼리문
	  		작 성 자 : 조계환
	  		일    시 : 2018-09-12     
	 -->
	<select id="sumProdPrice" parameterType="String" resultType="Integer">
		SELECT sum(a.prod_price* b.splylist_sum)
		FROM prod a, supply_list b
		WHERE b.supply_bcd=#{supply_bcd}
		AND a.prod_id = b.prod_id
	</select>
	
	
	<!-- 	아 이 디 : supplyMemberInfo
	  		반 환 값 : memberVo
	  		매개변수 : string(supply_bcd)
	  		설    명 : 입고 상세 내역에서 입고 편의점 점주의 정보를 가져오는 쿼리문
	  		작 성 자 : 조계환
	  		일    시 : 2018-09-12     
	 -->
	<select id="supplyMemberInfo" parameterType="String" resultType="memberVo">
		SELECT a.mem_cvs_name, a.mem_name, a.mem_cvs_tel, a.mem_kind, a.mem_addr 
		FROM member a, supply b
		WHERE b.supply_bcd=#{supply_bcd}
		and a.mem_kind = 01
		AND a.mem_id = b.place_id
	</select>
	
</mapper>